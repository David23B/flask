<!DOCTYPE html>

<html dir="ltr" lang="zh-hans">

<head profile="http://www.w3.org/1999/xhtml/vocab">
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="IE=edge,Chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <link href="https://cgyy.xmu.edu.cn/sites/default/files/logo_0.png" rel="shortcut icon" type="image/png" />
    <title>健身房预约 | 翔安校区体育馆预约系统</title>
    <style>
        @import url("https://cgyy.xmu.edu.cn/modules/system/system.base.css?sjj9t3");
    </style>
    <style>
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/date/date_api/date.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/date/date_popup/themes/datepicker.1.7.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/date/date_repeat_field/date_repeat_field.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/modules/field/theme/field.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/modules/node/node.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/views/css/views.css?sjj9t3");
    </style>
    <style>
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/ctools/css/ctools.css?sjj9t3");
        @import url("https://cgyy.xmu.edu.cn/sites/all/modules/room_reservations/room_reservations.css?sjj9t3");
    </style>
    <link href="https://cgyy.xmu.edu.cn/sites/all/themes/bootstrap/css/bootstrap.css" media="all" rel="stylesheet"
        type="text/css" />
    <link href="/sites/all/themes/bootstrap/css/drupal-bootstrap.css" media="all" rel="stylesheet" type="text/css" />
    <style>
        @import url("https://cgyy.xmu.edu.cn/sites/all/themes/bootstrap/css/custom.css?sjj9t3");
    </style>
    <!-- HTML5 element support for IE6-8 -->
    <!--[if lt IE 9]>
    <script src="http://apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"></script>
    <script src="http://apps.bdimg.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script
        src="https://cgyy.xmu.edu.cn/sites/all/modules/jquery_update/replace/jquery/1.10/jquery.js?v=1.10.2"></script>
    <script src="https://cgyy.xmu.edu.cn/misc/jquery-extend-3.4.0.js?v=1.10.2"></script>
    <script src="https://cgyy.xmu.edu.cn/misc/jquery-html-prefilter-3.5.0-backport.js?v=1.10.2"></script>
    <script src="https://cgyy.xmu.edu.cn/misc/jquery.once.js?v=1.2"></script>
    <script src="https://cgyy.xmu.edu.cn/misc/drupal.js?sjj9t3"></script>
    <script src="https://cgyy.xmu.edu.cn/sites/all/themes/bootstrap/js/bootstrap.js"></script>
    <script
        src="https://cgyy.xmu.edu.cn/sites/default/files/languages/zh-hans_C-Rb5wiQX-U3S-pj9DWrH-BbuR_27URKEBzSVIJEgqk.js?sjj9t3"></script>
    <script src="https://cgyy.xmu.edu.cn/sites/all/modules/room_reservations/room_reservations.js?sjj9t3"></script>
    <script>jQuery.extend(Drupal.settings, { "basePath": "\/", "pathPrefix": "", "setHasJsCookie": 0, "ajaxPageState": { "theme": "bootstrap", "theme_token": "ZiUv-C-NifyzOp6uTEjyJzjIE1M0DJ28EhHchjLCsjA", "js": { "sites\/all\/themes\/bootstrap\/js\/bootstrap.js": 1, "sites\/all\/modules\/jquery_update\/replace\/jquery\/1.10\/jquery.js": 1, "misc\/jquery-extend-3.4.0.js": 1, "misc\/jquery-html-prefilter-3.5.0-backport.js": 1, "misc\/jquery.once.js": 1, "misc\/drupal.js": 1, "https:\/\/cgyy.xmu.edu.cn\/sites\/all\/themes\/bootstrap\/js\/bootstrap.js": 1, "public:\/\/languages\/zh-hans_C-Rb5wiQX-U3S-pj9DWrH-BbuR_27URKEBzSVIJEgqk.js": 1, "sites\/all\/modules\/room_reservations\/room_reservations.js": 1 }, "css": { "modules\/system\/system.base.css": 1, "sites\/all\/modules\/date\/date_api\/date.css": 1, "sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css": 1, "sites\/all\/modules\/date\/date_repeat_field\/date_repeat_field.css": 1, "modules\/field\/theme\/field.css": 1, "modules\/node\/node.css": 1, "sites\/all\/modules\/views\/css\/views.css": 1, "sites\/all\/modules\/ctools\/css\/ctools.css": 1, "sites\/all\/modules\/room_reservations\/room_reservations.css": 1, "https:\/\/cgyy.xmu.edu.cn\/sites\/all\/themes\/bootstrap\/css\/bootstrap.css": 1, "https:\/\/cdn.jsdelivr.net\/npm\/@unicorn-fail\/drupal-bootstrap-styles@0.0.2\/dist\/3.3.1\/7.x-3.x\/drupal-bootstrap.css": 1, "sites\/all\/themes\/bootstrap\/css\/custom.css": 1 } }, "bootstrap": { "anchorsFix": 1, "anchorsSmoothScrolling": 1, "formHasError": 1, "popoverEnabled": 1, "popoverOptions": { "animation": 1, "html": 0, "placement": "right", "selector": "", "trigger": "click", "triggerAutoclose": 1, "title": "", "content": "", "delay": 0, "container": "body" }, "tooltipEnabled": 1, "tooltipOptions": { "animation": 1, "html": 0, "placement": "auto left", "selector": "", "trigger": "hover focus", "delay": 0, "container": "body" } } });</script>
</head>

<body class="html not-front not-logged-in no-sidebars page-room page-room- page-room-1">
    <div id="skip-link">
        <a class="element-invisible element-focusable" href="#main-content">跳转到主要内容</a>
    </div>
    <div class="website-content">
        <div class="website-head">
            <header class="navbar container navbar-default" id="navbar" role="banner">
                <div class="container">
                    <div class="navbar-header">
                        <a class="logo navbar-btn pull-left" href="/" title="首页">
                            <img alt="首页" src="https://cgyy.xmu.edu.cn/sites/default/files/logo.png" />
                        </a>
                        <a class="name navbar-brand" href="/" title="首页">翔安校区体育馆预约系统</a>
                        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
                        <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse"
                            type="button">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                    <div class="navbar-collapse collapse">
                        <nav role="navigation">
                            <!--          <div class="language-switcher">-->
                            <!--            <a href="?q=en">English</a> | <a href="?q=zh-hans">中文</a>-->
                            <!--          </div>-->
                            <div class="blank_zone hidden-xs visible-sm-block visible-md-block visible-lg-block">
                                你好，<span id="student_id"></span></div>
                            <div class="menu-zone">
                                <ul class="menu nav navbar-nav">
                                    <li class="first leaf menu-222"><a href="/" title="">首页</a></li>
                                    <li class_="leaf menu-697"><a href="/my_reservations" title="">我的预约</a></li>
                                    <li class="leaf menu-640"><a href="/room_reservations" title="">场地预约</a></li>
                                    <li class="leaf menu-854"><a class="active" href="/room/1" title="">健身房预约</a></li>
                                    <li class="leaf menu-1255"><a href="/room/2" title="">游泳馆预约</a></li>
                                    <li class="leaf menu-1598"><a href="/misd_query">违规查询</a></li>
                                    <li class="last leaf menu-696"><a href="/login" title="">退出</a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </header>
        </div>
        <div class="header_line"></div>
        <div class="main-container container">
            <header id="page-header" role="banner">
            </header> <!-- /#page-header -->
            <div class="row">
                <section class="col-sm-12">
                    <a id="main-content"></a>
                    <h1 class="title" id="page-title">
                        健身房预约 </h1>
                    <div class="region region-content">
                        <section class="block block-system clearfix" id="block-system-main">
                            <ul class="slot-list slot-list-1">
                                <li class="slot"><span class="date-info">2024-10-13 (星期天)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot fulled"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot fulled"><span>13:30-15:00</span></span><span
                                        class="time-slot fulled"><span>15:00-16:30</span></span><span
                                        class="time-slot fulled"><span>16:30-18:00</span></span><span
                                        class="time-slot fulled"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-14 (星期一)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot fulled"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot fulled"><span>13:30-15:00</span></span><span
                                        class="time-slot fulled"><span>15:00-16:30</span></span><span
                                        class="time-slot fulled"><span>16:30-18:00</span></span><span
                                        class="time-slot fulled"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-15 (星期二)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot fulled"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot fulled"><span>13:30-15:00</span></span><span
                                        class="time-slot fulled"><span>15:00-16:30</span></span><span
                                        class="time-slot fulled"><span>16:30-18:00</span></span><span
                                        class="time-slot fulled"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-16 (星期三)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot closed"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot closed"><span>13:30-15:00</span></span><span
                                        class="time-slot closed"><span>15:00-16:30</span></span><span
                                        class="time-slot closed"><span>16:30-18:00</span></span><span
                                        class="time-slot closed"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-17 (星期四)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot fulled"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot fulled"><span>13:30-15:00</span></span><span
                                        class="time-slot fulled"><span>15:00-16:30</span></span><span
                                        class="time-slot fulled"><span>16:30-18:00</span></span><span
                                        class="time-slot fulled"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-18 (星期五)</span>
                                    <div class="clearfix hidden-lg"></div><span
                                        class="time-slot fulled"><span>10:30-12:00</span></span><span
                                        class="time-slot fulled"><span>12:00-13:30</span></span><span
                                        class="time-slot closed"><span>13:30-15:00</span></span><span
                                        class="time-slot closed"><span>15:00-16:30</span></span><span
                                        class="time-slot closed"><span>16:30-18:00</span></span><span
                                        class="time-slot closed"><span>18:00-19:30</span></span><span
                                        class="time-slot fulled"><span>19:30-21:00</span></span>
                                </li>
                                <div class="clearfix"></div>
                                <li class="slot"><span class="date-info">2024-10-19 (星期六)</span>
                                    <div class="clearfix hidden-lg"></div><span class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/16/cg">10:30-12:00</a></span><span
                                        class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/10/cg">12:00-13:30</a></span><span
                                        class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/11/cg">13:30-15:00</a></span><span
                                        class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/12/cg">15:00-16:30</a></span><span
                                        class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/13/cg">16:30-18:00</a></span><span
                                        class="time-slot"><a
                                            href="/room_apl/1/2024-10-19/14/cg">18:00-19:30</a></span><span
                                        class="time-slot"><a href="/room_apl/1/2024-10-19/15/cg">19:30-21:00</a></span>
                                </li>
                                <div class="clearfix"></div>
                                <div class="help-info">预约说明：在预约前请先认真查看预约规则。<br /><span
                                        style="color:red;">自2024年9月14日起，将于每天下午13:00点后开放新一天的健身房预约。</span></div>
                                <div class="help-info"><span class="white_slot">      </span> 表示可预约

                                    <span class="green_slot">      </span> 表示您已预约

                                    <span class="blue_slot">      </span> 表示已被约满

                                    <span class="grey_slot">      </span> 表示不开放
                                </div>
                            </ul>
                            <!-- 添加开关 -->
                            <label>
                                <input id="reservationToggle" onchange="saveToggleState()" type="checkbox" /> 防误触
                            </label>
                        </section> <!-- /.block -->
                    </div>
                </section>
            </div>
        </div>
        <div class="main-footer-blank"></div>\
    </div>
    <footer class="footer container">
        <div class="region region-footer">
            <section class="block block-block clearfix" id="block-block-2">
                <p><a href="http://library.xmu.edu.cn/"> 厦门大学</a> 版权所有 ©2024<br /></p>
            </section> <!-- /.block -->
        </div>
    </footer>
    <script src="https://cgyy.xmu.edu.cn/sites/all/themes/bootstrap/js/bootstrap.js?sjj9t3"></script>
    <div aria-hidden="true" aria-labelledby="dialogLabel" class="modal fade" id="loadingModal" role="dialog">
        <div
            style="width: 200px;height:20px; z-index: 20000; position: absolute; text-align: center; left: 50%; top: 50%;margin-left:-100px;margin-top:-10px">
            <div class="progress progress-striped active" style="margin-bottom: 0;">
                <div class="progress-bar progress-bar-info" style="width: 100%;"></div>
            </div>
            <h4>正在加载...</h4>
        </div>
    </div>
    <script src="/sites/all/modules/services/js/bootstrap.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        jQuery(function () {
            jQuery('button#edit-submit').click(function () {
                jQuery('#loadingModal').modal({ backdrop: 'static', keyboard: false });
            });
            jQuery('button#edit-actions-submit').click(function () {
                jQuery('#loadingModal').modal({ backdrop: 'static', keyboard: false });
            });
        });
    </script>
    <script>
        const studentId = localStorage.getItem('student_id') || 'xxxxxxxxxxxxxx';

        document.getElementById('student_id').innerText = studentId;
    </script>
    <script>
        // 页面加载时读取开关状态
        document.addEventListener("DOMContentLoaded", function () {
            const toggleState = localStorage.getItem('reservationToggle');
            if (toggleState === 'true') {
                document.getElementById('reservationToggle').checked = true;
            }
        });
        // 保存开关状态
        function saveToggleState() {
            const isToggleOn = document.getElementById('reservationToggle').checked;
            localStorage.setItem('reservationToggle', isToggleOn);
        }

        function toggleSlot(span) {
            // 检查开关状态，确保在开关为关闭状态时才能执行预约逻辑
            const isReservationAllowed = localStorage.getItem('reservationToggle') === 'false';
            if (!isReservationAllowed) {
                return;
            }

            const dateInfo = span.closest('.slot').querySelector('.date-info').textContent.trim();
            const slotTime = span.textContent.trim();
            const slotId = `${dateInfo}_${slotTime}`;

            if (span.classList.contains('fulled')) {
                span.classList.remove('fulled');
                span.classList.add('booked');
                localStorage.setItem(slotId, 'booked');

                // 将预约信息存入 userReservations
                let reservations = JSON.parse(localStorage.getItem('userReservations')) || [];
                reservations.push({ date: dateInfo, time: slotTime });
                localStorage.setItem('userReservations', JSON.stringify(reservations));

            } else if (span.classList.contains('booked')) {
                span.classList.remove('booked');
                span.classList.add('fulled');
                localStorage.setItem(slotId, 'fulled');

                // 从 userReservations 中移除取消的预约
                let reservations = JSON.parse(localStorage.getItem('userReservations')) || [];
                reservations = reservations.filter(reservation => !(reservation.date === dateInfo && reservation.time === slotTime));
                localStorage.setItem('userReservations', JSON.stringify(reservations));
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const slots = document.querySelectorAll('.time-slot');
            slots.forEach(slot => {
                const dateInfo = slot.closest('.slot').querySelector('.date-info').textContent.trim();
                const slotTime = slot.textContent.trim();
                const slotId = `${dateInfo}_${slotTime}`; // 生成唯一标识符

                // 从 localStorage 中恢复状态
                const savedStatus = localStorage.getItem(slotId);
                if (savedStatus) {
                    slot.classList.remove('fulled', 'booked', 'closed');
                    slot.classList.add(savedStatus);
                }

                slot.addEventListener('click', () => {
                    toggleSlot(slot);
                });
            });
        });
    </script>
</body>

</html>